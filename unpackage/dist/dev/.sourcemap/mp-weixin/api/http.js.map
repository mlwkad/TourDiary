{"version":3,"file":"http.js","sources":["api/http.js"],"sourcesContent":["let baseUrl = ''\r\n\r\n// 判断环境\r\nif (process.env.NODE_ENV === 'development') {\r\n    baseUrl = 'http://localhost:3000'\r\n} else {\r\n    // baseUrl: 'http://localhost:3000'\r\n}\r\n\r\nexport default function http(url, data = {}, method = 'GET') {\r\n    return new Promise((resolve, reject) => {\r\n        uni.request({\r\n            url: baseUrl + url,\r\n            data,\r\n            method,\r\n            header: { // 注意这里修正了拼写错误 hearder -> header\r\n                'token': uni.getStorageSync('token') || ''\r\n            },\r\n            success: (res) => {\r\n                if (res.statusCode === 200 || res.statusCode === 201) {  // 包含创建成功状态码\r\n                    if (res.data.success === true) {  // 我们的API使用success表示成功\r\n                        resolve(res.data.data || res.data)\r\n                    }\r\n                    else {\r\n                        uni.showToast({\r\n                            title: res.data.message,\r\n                            icon: 'none'\r\n                        })\r\n                        reject(res.data.message)\r\n                    }\r\n                } else {\r\n                    uni.showToast({\r\n                        title: res.data.message || '请求失败',\r\n                        icon: 'none'\r\n                    })\r\n                    reject(res.data.message)\r\n                }\r\n            },\r\n            fail: (err) => {\r\n                console.log(err)\r\n                uni.showToast({\r\n                    title: '服务请求异常',\r\n                    icon: 'none'\r\n                })\r\n                reject(err)\r\n            }\r\n        })\r\n    })\r\n}\r\n"],"names":["uni"],"mappings":";;AAAA,IAAI,UAAU;AAG8B;AAC9B,YAAA;AACd;AAIA,SAAwB,KAAK,KAAK,OAAO,CAAA,GAAI,SAAS,OAAO;AACzD,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpCA,kBAAAA,MAAI,QAAQ;AAAA,MACR,KAAK,UAAU;AAAA,MACf;AAAA,MACA;AAAA,MACA,QAAQ;AAAA;AAAA,QACJ,SAASA,cAAA,MAAI,eAAe,OAAO,KAAK;AAAA,MAC5C;AAAA,MACA,SAAS,CAAC,QAAQ;AACd,YAAI,IAAI,eAAe,OAAO,IAAI,eAAe,KAAK;AAC9C,cAAA,IAAI,KAAK,YAAY,MAAM;AAC3B,oBAAQ,IAAI,KAAK,QAAQ,IAAI,IAAI;AAAA,UAAA,OAEhC;AACDA,0BAAAA,MAAI,UAAU;AAAA,cACV,OAAO,IAAI,KAAK;AAAA,cAChB,MAAM;AAAA,YAAA,CACT;AACM,mBAAA,IAAI,KAAK,OAAO;AAAA,UAC3B;AAAA,QAAA,OACG;AACHA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO,IAAI,KAAK,WAAW;AAAA,YAC3B,MAAM;AAAA,UAAA,CACT;AACM,iBAAA,IAAI,KAAK,OAAO;AAAA,QAC3B;AAAA,MACJ;AAAA,MACA,MAAM,CAAC,QAAQ;AACXA,sBAAAA,MAAA,MAAA,OAAA,qBAAY,GAAG;AACfA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACT;AACD,eAAO,GAAG;AAAA,MACd;AAAA,IAAA,CACH;AAAA,EAAA,CACJ;AACL;;"}