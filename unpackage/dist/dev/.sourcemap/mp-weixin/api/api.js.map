{"version":3,"file":"api.js","sources":["api/api.js"],"sourcesContent":["import http from \"./http.js\";\r\n\r\n// 首页\r\nexport const getBanner = () => {\r\n    return http('/api/getBanner')\r\n}\r\n\r\n// 换取sessionKey\r\nexport const getSessionKey = (url, data) => {\r\n    return http('/api/getSessionKey', data)\r\n}\r\n\r\n// 获取真实数据\r\nexport const getWXUserInfo = (url, data, method) => {\r\n    return http('/api/getUserInfo', data, method)\r\n}\r\n\r\n// 用户注册\r\nexport const signUp = (data) => {\r\n    return http('/api/signUp', data, 'POST')\r\n}\r\n\r\n// 用户登录\r\nexport const checkLogin = (data) => {\r\n    return http('/api/checkLogin', data, 'POST')\r\n}\r\n\r\n// 获取用户信息\r\nexport const getUserInfo = (userID) => {\r\n    return http(`/api/user/${userID}`)\r\n}\r\n\r\n// 更新用户信息\r\nexport const updateUserInfo = (userID, data) => {\r\n    return http(`/api/user/${userID}`, data, 'PUT')\r\n}\r\n\r\n// 获取用户发布的内容\r\nexport const getUserReleases = (userID) => {\r\n    return http(`/api/user/${userID}/releases`)\r\n}\r\n\r\n// 获取用户喜欢的内容\r\nexport const getUserLiked = (userID) => {\r\n    return http(`/api/user/${userID}/liked`)\r\n}\r\n\r\n// 添加喜欢的内容\r\nexport const addLiked = (userID, releaseID) => {\r\n    return http(`/api/user/${userID}/liked`, { releaseID }, 'POST')\r\n}\r\n\r\n// 取消喜欢的内容\r\nexport const removeLiked = (userID, releaseID) => {\r\n    return http(`/api/user/${userID}/liked/${releaseID}`, {}, 'DELETE')\r\n}\r\n\r\n// 获取所有发布内容\r\nexport const getAllReleases = (limit = 50, offset = 0) => {\r\n    return http(`/api/releases`, { limit, offset })\r\n}\r\n\r\n// 搜索相关内容\r\nexport const searchReleases = (data) => {\r\n    return http('/api/releases/search', data, 'POST')\r\n}\r\n\r\n// 获取发布内容详情\r\nexport const getReleaseDetail = (releaseID) => {\r\n    return http(`/api/release/${releaseID}`)\r\n}\r\n\r\n// 创建发布内容\r\nexport const createRelease = (data) => {\r\n    return http('/api/release', data, 'POST')\r\n}\r\n\r\n// 更新发布内容\r\nexport const updateRelease = (releaseID, data) => {\r\n    return http(`/api/release/${releaseID}`, data, 'PUT')\r\n}\r\n\r\n// 删除发布内容\r\nexport const deleteRelease = (releaseID, userID) => {\r\n    return http(`/api/release/${releaseID}`, { userID }, 'DELETE')\r\n}\r\n\r\n// 上传文件\r\nexport const uploadFiles = (filePaths) => {\r\n    return new Promise((resolve, reject) => {\r\n        const uploadTask = uni.uploadFile({\r\n            url: baseUrl + '/api/upload',\r\n            files: filePaths.map(path => ({\r\n                name: 'files',\r\n                uri: path\r\n            })),\r\n            name: 'files',\r\n            success: (res) => {\r\n                if (res.statusCode === 200) {\r\n                    const data = JSON.parse(res.data);\r\n                    if (data.success) {\r\n                        resolve(data.data);\r\n                    } else {\r\n                        uni.showToast({\r\n                            title: data.message,\r\n                            icon: 'none'\r\n                        });\r\n                        reject(data.message);\r\n                    }\r\n                } else {\r\n                    uni.showToast({\r\n                        title: '上传失败',\r\n                        icon: 'none'\r\n                    });\r\n                    reject('上传失败');\r\n                }\r\n            },\r\n            fail: (err) => {\r\n                console.log(err);\r\n                uni.showToast({\r\n                    title: '上传请求异常',\r\n                    icon: 'none'\r\n                });\r\n                reject(err);\r\n            }\r\n        });\r\n    });\r\n}"],"names":["http"],"mappings":";;;AAQY,MAAC,gBAAgB,CAAC,KAAK,SAAS;AACxC,SAAOA,SAAI,KAAC,sBAAsB,IAAI;AAC1C;AAGY,MAAC,gBAAgB,CAAC,KAAK,MAAM,WAAW;AAChD,SAAOA,cAAK,oBAAoB,MAAM,MAAM;AAChD;AAGY,MAAC,SAAS,CAAC,SAAS;AAC5B,SAAOA,cAAK,eAAe,MAAM,MAAM;AAC3C;AAGY,MAAC,aAAa,CAAC,SAAS;AAChC,SAAOA,cAAK,mBAAmB,MAAM,MAAM;AAC/C;AAaY,MAAC,kBAAkB,CAAC,WAAW;AACvC,SAAOA,SAAI,KAAC,aAAa,MAAM,WAAW;AAC9C;AAGY,MAAC,eAAe,CAAC,WAAW;AACpC,SAAOA,SAAI,KAAC,aAAa,MAAM,QAAQ;AAC3C;AAGY,MAAC,WAAW,CAAC,QAAQ,cAAc;AAC3C,SAAOA,SAAI,KAAC,aAAa,MAAM,UAAU,EAAE,UAAW,GAAE,MAAM;AAClE;AAGY,MAAC,cAAc,CAAC,QAAQ,cAAc;AAC9C,SAAOA,SAAI,KAAC,aAAa,MAAM,UAAU,SAAS,IAAI,CAAE,GAAE,QAAQ;AACtE;AAGY,MAAC,iBAAiB,CAAC,QAAQ,IAAI,SAAS,MAAM;AACtD,SAAOA,SAAAA,KAAK,iBAAiB,EAAE,OAAO,OAAM,CAAE;AAClD;AAGY,MAAC,iBAAiB,CAAC,SAAS;AACpC,SAAOA,cAAK,wBAAwB,MAAM,MAAM;AACpD;AAGY,MAAC,mBAAmB,CAAC,cAAc;AAC3C,SAAOA,cAAK,gBAAgB,SAAS,EAAE;AAC3C;AAGY,MAAC,gBAAgB,CAAC,SAAS;AACnC,SAAOA,cAAK,gBAAgB,MAAM,MAAM;AAC5C;;;;;;;;;;;;;"}