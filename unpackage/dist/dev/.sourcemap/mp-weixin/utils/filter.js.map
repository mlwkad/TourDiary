{"version":3,"file":"filter.js","sources":["utils/filter.js"],"sourcesContent":["export function filterSqlInjection(text) {\r\n    if (!text) return ''\r\n    const sqlPattern = /('|\"|;|--|\\/\\*|\\*\\/|@@|@|char|nchar|varchar|nvarchar|alter|begin|cast|create|cursor|declare|delete|drop|end|exec|execute|fetch|insert|kill|open|select|sys|sysobjects|syscolumns|table|update)/gi\r\n    return text.replace(sqlPattern, '')\r\n        .replace(/[<>]/g, '') // 移除HTML标签字符\r\n        .trim()\r\n}\r\n\r\nexport function validateUsername(username) {\r\n    if (!username || !username.trim()) {\r\n        return { isValid: false, message: '用户名不能为空', filteredText: '' }\r\n    }\r\n    const filteredUsername = filterSqlInjection(username)\r\n    if (filteredUsername.length < 3) {\r\n        return { isValid: false, message: '用户名不能少于3个字符', filteredText: filteredUsername }\r\n    }\r\n    if (filteredUsername.length > 20) {\r\n        return { isValid: false, message: '用户名不能超过20个字符', filteredText: filteredUsername }\r\n    }\r\n    const usernamePattern = /^[a-zA-Z0-9_\\u4e00-\\u9fa5]+$/\r\n    if (!usernamePattern.test(filteredUsername)) {\r\n        return { isValid: false, message: '用户名只能包含字母、数字、下划线和中文', filteredText: filteredUsername }\r\n    }\r\n    const sensitiveWords = /(赌博|色情|暴力|政治|违法)/gi\r\n    if (sensitiveWords.test(filteredUsername)) {\r\n        return { isValid: false, message: '用户名包含敏感词汇', filteredText: filteredUsername }\r\n    }    \r\n    return { isValid: true, message: '', filteredText: filteredUsername }\r\n}\r\n\r\nexport function validatePassword(password) {\r\n    if (!password) {\r\n        return { isValid: false, message: '密码不能为空', filteredText: '' }\r\n    }\r\n    if (password.length < 6) {\r\n        return { isValid: false, message: '密码不能少于6个字符', filteredText: password }\r\n    }\r\n    if (password.length > 20) {\r\n        return { isValid: false, message: '密码不能超过20个字符', filteredText: password }\r\n    }\r\n    const passwordPattern = /^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d@$!%*#?&]{6,}$/\r\n    if (!passwordPattern.test(password)) {\r\n        return { isValid: false, message: '密码必须包含至少一个字母和一个数字', filteredText: password }\r\n    }\r\n    return { isValid: true, message: '', filteredText: password }\r\n}\r\n\r\n// 验证搜索内容\r\nexport function validateSearch(search) {\r\n    if (!search || !search.trim()) {\r\n        return { isValid: false, message: '搜索内容不能为空', filteredText: '' }\r\n    }\r\n    const filteredSearch = filterSqlInjection(search)\r\n    if (filteredSearch.length > 10) {\r\n        return { isValid: false, message: '搜索内容不能超过10个字符', filteredText: filteredSearch.substring(0, 10) }\r\n    }\r\n    const sensitiveWords = /(赌博|色情|暴力|政治|违法)/gi\r\n    if (sensitiveWords.test(filteredSearch)) {\r\n        return { isValid: false, message: '搜索内容包含敏感词汇', filteredText: filteredSearch }\r\n    }\r\n    return { isValid: true, message: '', filteredText: filteredSearch }\r\n}\r\n\r\nexport function validateTitle(title, maxLength = 15) {\r\n    if (!title || !title.trim()) {  // 不能为空\r\n        return { isValid: false, message: '标题不能为空', filteredText: '' }\r\n    }\r\n    const filteredTitle = filterSqlInjection(title)\r\n    if (filteredTitle.length > maxLength) {\r\n        return { isValid: false, message: `标题不能超过${maxLength}个字符`, filteredText: filteredTitle }\r\n    }\r\n    const sensitiveWords = /(赌博|色情|暴力|政治|违法)/gi\r\n    if (sensitiveWords.test(filteredTitle)) {\r\n        return { isValid: false, message: '标题包含敏感词汇', filteredText: filteredTitle }\r\n    }\r\n    return { isValid: true, message: '', filteredText: filteredTitle }\r\n}\r\n\r\nexport function validateContent(content, minLength = 10) {\r\n    if (!content || !content.trim()) {\r\n        return { isValid: false, message: '内容描述不能为空', filteredText: '' }\r\n    }\r\n    const filteredContent = filterSqlInjection(content)\r\n    if (filteredContent.length < minLength) {\r\n        return { isValid: false, message: `内容描述不能少于${minLength}个字符`, filteredText: filteredContent }\r\n    }\r\n    const sensitiveWords = /(赌博|色情|暴力|政治|违法)/gi\r\n    if (sensitiveWords.test(filteredContent)) {\r\n        return { isValid: false, message: '内容包含敏感词汇', filteredText: filteredContent };\r\n    }\r\n\r\n    return { isValid: true, message: '', filteredText: filteredContent };\r\n}\r\n\r\nexport function validateLocation(location) {\r\n    if (!location || !location.trim()) {\r\n        return { isValid: false, message: '位置不能为空', filteredText: '' }\r\n    }\r\n    const filteredLocation = filterSqlInjection(location)\r\n    if (filteredLocation.length > 25) {\r\n        return { isValid: false, message: '位置信息过长', filteredText: filteredLocation }\r\n    }\r\n    return { isValid: true, message: '', filteredText: filteredLocation }\r\n}\r\n"],"names":[],"mappings":"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"}