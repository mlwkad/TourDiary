{"version":3,"file":"filter.js","sources":["utils/filter.js"],"sourcesContent":["// * 过滤校验\r\n// * 1.数据合理性\r\n// * 2.后端 参数化查询\r\n\r\nconst sensitive = /(赌博|色情|暴力|政治|违法)/gi\r\n\r\nexport function validateUsername(username) {\r\n    if (!username || !username.trim()) return { isValid: false, message: '用户名不能为空', filteredText: '' }\r\n    const filteredUsername = filterSql(username)\r\n    if (filteredUsername.length < 3) return { isValid: false, message: '用户名不能少于3个字符', filteredText: filteredUsername }\r\n    if (filteredUsername.length > 20) return { isValid: false, message: '用户名不能超过20个字符', filteredText: filteredUsername }\r\n    const usernamePattern = /^[a-zA-Z0-9_\\u4e00-\\u9fa5]+$/\r\n    if (!usernamePattern.test(filteredUsername)) return { isValid: false, message: '用户名只能包含字母、数字、下划线和中文', filteredText: filteredUsername }\r\n    if (sensitive.test(filteredUsername)) return { isValid: false, message: '用户名包含敏感词汇', filteredText: filteredUsername }\r\n    return { isValid: true, message: '', filteredText: filteredUsername }\r\n}\r\n\r\nexport function validatePassword(password) {\r\n    if (!password) return { isValid: false, message: '密码不能为空', filteredText: '' }\r\n    if (password.length < 6) return { isValid: false, message: '密码不能少于6个字符', filteredText: password }\r\n    if (password.length > 20) return { isValid: false, message: '密码不能超过20个字符', filteredText: password }\r\n    const passwordPattern = /^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d@$!%*#?&]{6,}$/\r\n    if (!passwordPattern.test(password)) return { isValid: false, message: '密码必须包含至少一个字母和一个数字', filteredText: password }\r\n    return { isValid: true, message: '', filteredText: password }\r\n}\r\n\r\nexport function validateSearch(search) {\r\n    if (!search || !search.trim()) return { isValid: false, message: '搜索内容不能为空', filteredText: '' }\r\n    const filteredSearch = filterSql(search)\r\n    if (filteredSearch.length > 10) return { isValid: false, message: '搜索内容不能超过10个字符', filteredText: filteredSearch.substring(0, 10) }\r\n    if (sensitive.test(filteredSearch)) return { isValid: false, message: '搜索内容包含敏感词汇', filteredText: filteredSearch }\r\n    return { isValid: true, message: '', filteredText: filteredSearch }\r\n}\r\n\r\nexport function validateTitle(title, maxLength = 15) {\r\n    if (!title || !title.trim()) return { isValid: false, message: '标题不能为空', filteredText: '' }\r\n    const filteredTitle = filterSql(title)\r\n    if (filteredTitle.length > maxLength) return { isValid: false, message: `标题不能超过${maxLength}个字符`, filteredText: filteredTitle }\r\n    if (sensitive.test(filteredTitle)) return { isValid: false, message: '标题包含敏感词汇', filteredText: filteredTitle }\r\n    return { isValid: true, message: '', filteredText: filteredTitle }\r\n}\r\n\r\nexport function validateContent(content, minLength = 10) {\r\n    if (!content || !content.trim()) return { isValid: false, message: '内容描述不能为空', filteredText: '' }\r\n    const filteredContent = filterSql(content)\r\n    if (filteredContent.length < minLength) return { isValid: false, message: `内容描述不能少于${minLength}个字符`, filteredText: filteredContent }\r\n    if (sensitive.test(filteredContent)) return { isValid: false, message: '内容包含敏感词汇', filteredText: filteredContent }\r\n    return { isValid: true, message: '', filteredText: filteredContent }\r\n}\r\n\r\nexport function validateLocation(location) {\r\n    if (!location || !location.trim()) return { isValid: false, message: '位置不能为空', filteredText: '' }\r\n    const filteredLocation = filterSql(location)\r\n    if (filteredLocation.length > 25) return { isValid: false, message: '位置信息过长', filteredText: filteredLocation }\r\n    return { isValid: true, message: '', filteredText: filteredLocation }\r\n}\r\n"],"names":[],"mappings":"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"}