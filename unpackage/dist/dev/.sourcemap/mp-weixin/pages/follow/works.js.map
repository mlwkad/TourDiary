{"version":3,"file":"works.js","sources":["pages/follow/works.vue","../../uniapp/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZm9sbG93L3dvcmtzLnZ1ZQ"],"sourcesContent":["<template>\r\n    <view class=\"works-container\">\r\n        <view class=\"user-profile\">\r\n            <image class=\"user-avatar\" src=\"/static/666.jpg\" mode=\"aspectFill\"></image>\r\n            <view class=\"user-info\">\r\n                <view class=\"user-name\">{{ userData.userName }}</view>\r\n                <view class=\"user-stats\">\r\n                    <view class=\"stat-item\">\r\n                        <view class=\"stat-value\">{{ userData.release ? JSON.parse(userData.release).length : 0 }}</view>\r\n                        <view class=\"stat-label\">作品</view>\r\n                    </view>\r\n                </view>\r\n            </view>\r\n            <view class=\"follow-action\">\r\n                <view class=\"follow-btn\" @click=\"toggleFollow\">\r\n                    {{ isFollowing ? '已关注' : '+ 关注' }}\r\n                </view>\r\n            </view>\r\n        </view>\r\n\r\n        <scroll-view scroll-y class=\"content-area\" refresher-enabled @refresherrefresh=\"onRefresh\"\r\n            :refresher-triggered=\"isRefreshing\">\r\n            <template v-if=\"userWorks.length > 0\">\r\n                <view class=\"works-list\">\r\n                    <view class=\"work-item\" v-for=\"(item, index) in userWorks\" :key=\"index\"\r\n                        @click=\"viewWorkDetail(item.releaseID)\">\r\n                        <view class=\"work-header\">\r\n                            <view class=\"work-title\">{{ item.title }}</view>\r\n                        </view>\r\n                        <view class=\"work-body\">\r\n                            <image class=\"work-image\" src=\"/static/666.jpg\" mode=\"aspectFill\"></image>\r\n                            <view class=\"work-content\">\r\n                                <view class=\"work-desc\">{{ item.content }}</view>\r\n                            </view>\r\n                        </view>\r\n                        <view class=\"work-meta\">\r\n                            <view class=\"meta-item\" v-if=\"item.createdAt\">\r\n                                <image class=\"meta-icon\" src=\"/static/public/time.png\"></image>\r\n                                <text>{{ item.createdAt.slice(0, 10) }}</text>\r\n                            </view>\r\n                            <view class=\"meta-item\" v-if=\"item.location\">\r\n                                <image class=\"meta-icon\" src=\"/static/public/location.png\"></image>\r\n                                <text>{{ item.location }}</text>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n\r\n                <!-- 底部提示 -->\r\n                <view class=\"list-footer\" v-if=\"userWorks.length > 5\">\r\n                    <text>已经到底啦~</text>\r\n                </view>\r\n            </template>\r\n            <template v-else>\r\n                <view class=\"empty-state\">\r\n                    <image class=\"empty-icon\" src=\"/static/public/search.png\" mode=\"aspectFit\"></image>\r\n                    <view class=\"empty-text\">暂无作品</view>\r\n                    <view class=\"empty-subtext\">该用户还没有发布任何作品</view>\r\n                </view>\r\n            </template>\r\n        </scroll-view>\r\n    </view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive } from 'vue';\r\nimport { onLoad } from '@dcloudio/uni-app'\r\nimport { getReleaseDetail, getUserReleases, getUserInfo, follow, unfollow, getFollowingList } from '../../api/api';\r\n\r\n// 用户信息\r\nconst userData = reactive({})\r\nlet userID = ref<string>('')\r\n\r\n// 是否关注\r\nconst isFollowing = ref(true)\r\n\r\n// 关注状态\r\nconst isRefreshing = ref(false)\r\n\r\n// 用户作品列表\r\nconst userWorks = ref<any[]>([\r\n    {\r\n        releaseID: 'release1',\r\n        title: '北京三日游',\r\n        content: '游览了故宫、长城、颐和园等著名景点，感受了浓厚的历史文化氛围。',\r\n        createdAt: '2023-05-15T10:30:00.000Z',\r\n        location: '北京市',\r\n        pictures: ['/static/666.jpg']\r\n    },\r\n    {\r\n        releaseID: 'release2',\r\n        title: '杭州西湖一日游',\r\n        content: '西湖美景让人心旷神怡，苏堤春晓、断桥残雪都是绝佳的景点。',\r\n        createdAt: '2023-06-20T15:45:00.000Z',\r\n        location: '杭州市',\r\n        pictures: ['/static/666.jpg']\r\n    },\r\n    {\r\n        releaseID: 'release3',\r\n        title: '上海都市风光',\r\n        content: '上海的现代化都市风光令人惊叹，外滩夜景尤为壮观。',\r\n        createdAt: '2023-07-10T09:15:00.000Z',\r\n        location: '上海市',\r\n        pictures: ['/static/666.jpg']\r\n    }\r\n])\r\n\r\n// 查看作品详情\r\nconst viewWorkDetail = async (releaseID: string) => {\r\n    try {\r\n        const info = await getReleaseDetail(releaseID)\r\n        uni.navigateTo({\r\n            url: `/pages/detail/detail?info=${encodeURIComponent(JSON.stringify(info))}`\r\n        })\r\n    } catch (error) {\r\n        uni.showToast({\r\n            title: '获取详情失败',\r\n            icon: 'none'\r\n        })\r\n    }\r\n}\r\n\r\n// 切换关注状态\r\nconst toggleFollow = () => {\r\n    userID.value = JSON.parse(uni.getStorageSync('userInfo')).userId\r\n    if (isFollowing.value) {\r\n        uni.showModal({\r\n            title: '提示',\r\n            content: `确定要取消关注\"${userData.userName}\"吗？`,\r\n            success: (res) => {\r\n                if (res.confirm) {\r\n                    // 这里应该调用取消关注的API\r\n                    unfollow(userID.value, userData.userID).then(res => {\r\n                        isFollowing.value = false\r\n                        uni.showToast({\r\n                            title: '已取消关注',\r\n                            icon: 'success'\r\n                        })\r\n                    })\r\n                }\r\n            }\r\n        })\r\n    } else {\r\n        // 这里应该调用关注用户的API\r\n        follow(userID.value, { followUserID: userData.userID }).then(res => {\r\n            isFollowing.value = true\r\n            uni.showToast({\r\n                title: '关注成功',\r\n                icon: 'success'\r\n            })\r\n        })\r\n    }\r\n}\r\n\r\n// 刷新数据\r\nconst onRefresh = async () => {\r\n    isRefreshing.value = true\r\n    // 模拟获取用户作品的API调用\r\n    await new Promise((resolve) => {\r\n        setTimeout(() => {\r\n            isRefreshing.value = false\r\n            resolve(null)\r\n        }, 500);\r\n    })\r\n}\r\n\r\nonLoad((options) => {\r\n    if (options.userID) {\r\n        getUserReleases(options.userID).then(res => {\r\n            userWorks.value = res\r\n        })\r\n        getUserInfo(options.userID).then(res => {\r\n            Object.assign(userData, res)\r\n        })\r\n        const userInfo = uni.getStorageSync('userInfo')\r\n        getFollowingList(JSON.parse(userInfo).userId).then(res => {\r\n            isFollowing.value = res.includes(options.userID)\r\n        })\r\n    }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.works-container {\r\n    width: 100%;\r\n    min-height: 100vh;\r\n    background: linear-gradient(to bottom, #f0f5ff, #ffffff);\r\n    display: flex;\r\n    flex-direction: column;\r\n    position: relative;\r\n    padding-bottom: 30rpx;\r\n\r\n    &::before {\r\n        content: '';\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        height: 400rpx;\r\n        background: linear-gradient(135deg, rgba(52, 148, 230, 0.15), rgba(236, 110, 173, 0.1));\r\n        z-index: -1;\r\n        border-radius: 0 0 30% 30%;\r\n    }\r\n\r\n    &::after {\r\n        content: '';\r\n        position: absolute;\r\n        top: 15%;\r\n        right: 5%;\r\n        width: 100rpx;\r\n        height: 100rpx;\r\n        border-radius: 50%;\r\n        background: linear-gradient(135deg, rgba(236, 110, 173, 0.2), rgba(52, 148, 230, 0.1));\r\n        filter: blur(30rpx);\r\n        z-index: -1;\r\n    }\r\n\r\n    .user-profile {\r\n        margin: 30rpx 20rpx 20rpx;\r\n        padding: 30rpx;\r\n        background-color: rgba(255, 255, 255, 0.9);\r\n        border-radius: 20rpx;\r\n        box-shadow: 0 0 15rpx 0 rgba(0, 0, 0, 0.1);\r\n        backdrop-filter: none;\r\n        border: 1px solid rgba(255, 255, 255, 0.6);\r\n        display: flex;\r\n        align-items: center;\r\n        position: relative;\r\n\r\n        .user-avatar {\r\n            width: 140rpx;\r\n            height: 140rpx;\r\n            border-radius: 50%;\r\n            margin-right: 30rpx;\r\n            box-shadow: 0 5rpx 10rpx rgba(0, 0, 0, 0.1);\r\n            border: 3rpx solid #fff;\r\n        }\r\n\r\n        .user-info {\r\n            flex: 1;\r\n\r\n            .user-name {\r\n                font-size: 36rpx;\r\n                font-weight: bold;\r\n                margin-bottom: 12rpx;\r\n                background: linear-gradient(90deg, #3494E6, #555);\r\n                -webkit-background-clip: text;\r\n                background-clip: text;\r\n                color: transparent;\r\n                margin-left: 8rpx;\r\n                text-shadow: 0 0 1px rgba(52, 148, 230, 0.1);\r\n            }\r\n\r\n            .user-stats {\r\n                display: flex;\r\n                margin-top: 15rpx;\r\n\r\n                .stat-item {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    background: rgba(52, 148, 230, 0.1);\r\n                    padding: 8rpx 20rpx;\r\n                    border-radius: 30rpx;\r\n\r\n                    .stat-value {\r\n                        font-size: 30rpx;\r\n                        font-weight: bold;\r\n                        color: #3494E6;\r\n                        margin-right: 8rpx;\r\n                    }\r\n\r\n                    .stat-label {\r\n                        font-size: 24rpx;\r\n                        color: #666;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .follow-action {\r\n            .follow-btn {\r\n                padding: 15rpx 30rpx;\r\n                border-radius: 40rpx;\r\n                font-size: 28rpx;\r\n                color: #fff;\r\n                background: linear-gradient(135deg, #3494E6, #EC6EAD);\r\n                box-shadow: 0 3rpx 8rpx rgba(0, 0, 0, 0.1);\r\n                transition: all 0.3s ease;\r\n                white-space: nowrap;\r\n\r\n                &:active {\r\n                    transform: scale(0.95);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .content-area {\r\n        flex: 1;\r\n        padding: 10rpx 20rpx 20rpx;\r\n        min-height: fit-content;\r\n        width: 95%;\r\n        margin: 0 auto;\r\n\r\n        .works-list {\r\n            .work-item {\r\n                width: 91%;\r\n                background-color: rgba(255, 255, 255, 0.9);\r\n                border-radius: 20rpx;\r\n                margin-bottom: 30rpx;\r\n                padding: 25rpx;\r\n                display: flex;\r\n                flex-direction: column;\r\n                box-shadow: 0 0 15rpx 0 rgba(0, 0, 0, 0.1);\r\n                backdrop-filter: none;\r\n                border: 1px solid rgba(255, 255, 255, 0.6);\r\n                transition: all 0.3s ease;\r\n                position: relative;\r\n                overflow: hidden;\r\n\r\n                &::before {\r\n                    content: '';\r\n                    position: absolute;\r\n                    top: 0;\r\n                    left: 0;\r\n                    width: 6rpx;\r\n                    height: 100%;\r\n                    background: linear-gradient(to bottom, #3494E6, #EC6EAD);\r\n                    opacity: 0.7;\r\n                }\r\n\r\n                &:active {\r\n                    transform: translateY(-5rpx);\r\n                    box-shadow: 0 8rpx 20rpx rgba(0, 0, 0, 0.15);\r\n                }\r\n\r\n                .work-header {\r\n                    margin-bottom: 15rpx;\r\n\r\n                    .work-title {\r\n                        font-size: 32rpx;\r\n                        font-weight: bold;\r\n                        background: linear-gradient(90deg, #3494E6, #555);\r\n                        -webkit-background-clip: text;\r\n                        background-clip: text;\r\n                        color: transparent;\r\n                        text-shadow: 0 0 1px rgba(52, 148, 230, 0.1);\r\n                        position: relative;\r\n                        padding-bottom: 10rpx;\r\n\r\n                        &::after {\r\n                            content: '';\r\n                            position: absolute;\r\n                            bottom: 0;\r\n                            left: 0;\r\n                            width: 60rpx;\r\n                            height: 3rpx;\r\n                            background: linear-gradient(90deg, #3494E6, transparent);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                .work-body {\r\n                    display: flex;\r\n                    margin-bottom: 20rpx;\r\n\r\n                    .work-image {\r\n                        width: 180rpx;\r\n                        height: 140rpx;\r\n                        border-radius: 15rpx;\r\n                        margin-right: 20rpx;\r\n                        box-shadow: 0 5rpx 10rpx rgba(0, 0, 0, 0.1);\r\n                        flex-shrink: 0;\r\n                    }\r\n\r\n                    .work-content {\r\n                        flex: 1;\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                        justify-content: center;\r\n\r\n                        .work-desc {\r\n                            font-size: 26rpx;\r\n                            color: #333;\r\n                            display: -webkit-box;\r\n                            -webkit-line-clamp: 3;\r\n                            line-clamp: 3;\r\n                            -webkit-box-orient: vertical;\r\n                            text-overflow: ellipsis;\r\n                            overflow: hidden;\r\n                            line-height: 1.6;\r\n                            background: linear-gradient(90deg, rgba(52, 148, 230, 0.15), rgba(236, 110, 173, 0.05));\r\n                            padding: 10rpx 15rpx;\r\n                            border-radius: 10rpx;\r\n                            border-left: 3rpx solid rgba(52, 148, 230, 0.6);\r\n                            height: 100%;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                .work-meta {\r\n                    display: flex;\r\n                    flex-wrap: wrap;\r\n                    gap: 15rpx;\r\n                    justify-content: flex-start;\r\n                    width: 100%;\r\n\r\n                    .meta-item {\r\n                        font-size: 24rpx;\r\n                        color: #888;\r\n                        display: flex;\r\n                        align-items: center;\r\n                        background-color: rgba(0, 0, 0, 0.05);\r\n                        padding: 6rpx 16rpx;\r\n                        border-radius: 20rpx;\r\n                        width: fit-content;\r\n                        min-width: 100rpx;\r\n\r\n                        .meta-icon {\r\n                            width: 24rpx;\r\n                            height: 24rpx;\r\n                            margin-right: 8rpx;\r\n                            flex-shrink: 0;\r\n                        }\r\n\r\n                        text {\r\n                            white-space: nowrap;\r\n                            overflow: hidden;\r\n                            text-overflow: ellipsis;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .list-footer {\r\n            text-align: center;\r\n            padding: 30rpx 0;\r\n            color: #999;\r\n            font-size: 24rpx;\r\n        }\r\n\r\n        .empty-state {\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            padding: 150rpx 0;\r\n\r\n            .empty-icon {\r\n                width: 250rpx;\r\n                height: 250rpx;\r\n                margin-bottom: 40rpx;\r\n                opacity: 0.6;\r\n                animation: float 3s ease-in-out infinite;\r\n            }\r\n\r\n            .empty-text {\r\n                font-size: 36rpx;\r\n                color: #999;\r\n                margin-bottom: 15rpx;\r\n                text-shadow: 1rpx 1rpx 2rpx rgba(0, 0, 0, 0.1);\r\n            }\r\n\r\n            .empty-subtext {\r\n                font-size: 28rpx;\r\n                color: #aaa;\r\n                margin-bottom: 40rpx;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@keyframes float {\r\n    0% {\r\n        transform: translateY(0);\r\n    }\r\n\r\n    50% {\r\n        transform: translateY(-10rpx);\r\n    }\r\n\r\n    100% {\r\n        transform: translateY(0);\r\n    }\r\n}\r\n</style>","import MiniProgramPage from 'D:/uniappProject/旅游日记uniapp/pages/follow/works.vue'\nwx.createPage(MiniProgramPage)"],"names":["reactive","ref","getReleaseDetail","uni","unfollow","res","follow","onLoad","getUserReleases","getUserInfo","getFollowingList"],"mappings":"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"}