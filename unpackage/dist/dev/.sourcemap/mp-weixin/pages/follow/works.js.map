{"version":3,"file":"works.js","sources":["pages/follow/works.vue","../../uniapp/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZm9sbG93L3dvcmtzLnZ1ZQ"],"sourcesContent":["<template>\r\n    <view class=\"works-container\">\r\n        <view class=\"user-profile\">\r\n            <image class=\"user-avatar\" src=\"/static/666.jpg\" mode=\"aspectFill\"></image>\r\n            <view class=\"user-info\">\r\n                <view class=\"user-name\">{{ userData.userName }}</view>\r\n                <view class=\"user-stats\">\r\n                    <view class=\"stat-item\">\r\n                        <view class=\"stat-value\">{{ userWorks.length }}</view>\r\n                        <view class=\"stat-label\">作品</view>\r\n                    </view>\r\n                </view>\r\n            </view>\r\n            <view class=\"follow-action\">\r\n                <view class=\"follow-btn\" @click=\"toggleFollow\">\r\n                    {{ isFollowing ? '已关注' : '+ 关注' }}\r\n                </view>\r\n            </view>\r\n        </view>\r\n        <!-- refresher-enabled @refresherrefresh=\"onRefresh\" :refresher-triggered=\"isRefreshing\" -->\r\n        <scroll-view scroll-y class=\"content-area\">\r\n            <template v-if=\"userWorks.length > 0\">\r\n                <view class=\"works-list\">\r\n                    <view class=\"work-item\" v-for=\"(item, index) in userWorks\" :key=\"index\"\r\n                        @click=\"viewWorkDetail(item.releaseID)\">\r\n                        <view class=\"work-header\">\r\n                            <view class=\"work-title\">{{ item.title }}</view>\r\n                        </view>\r\n                        <view class=\"work-body\">\r\n                            <image class=\"work-image\" src=\"/static/666.jpg\" mode=\"aspectFill\"></image>\r\n                            <view class=\"work-content\">\r\n                                <view class=\"work-desc\">{{ item.content }}</view>\r\n                            </view>\r\n                        </view>\r\n                        <view class=\"work-meta\">\r\n                            <view class=\"meta-item\" v-if=\"item.createdAt\">\r\n                                <image class=\"meta-icon\" src=\"/static/public/time.png\"></image>\r\n                                <text>{{ item.createdAt.slice(0, 10) }}</text>\r\n                            </view>\r\n                            <view class=\"meta-item\" v-if=\"item.location\">\r\n                                <image class=\"meta-icon\" src=\"/static/public/location.png\"></image>\r\n                                <text>{{ item.location }}</text>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n                <view class=\"list-footer\" v-if=\"userWorks.length > 5\">\r\n                    <text>已经到底啦~</text>\r\n                </view>\r\n            </template>\r\n            <template v-else>\r\n                <view class=\"empty-state\">\r\n                    <image class=\"empty-icon\" src=\"/static/public/search.png\" mode=\"aspectFit\"></image>\r\n                    <view class=\"empty-text\">暂无作品</view>\r\n                    <view class=\"empty-subtext\">该用户还没有发布任何作品</view>\r\n                </view>\r\n            </template>\r\n        </scroll-view>\r\n    </view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive } from 'vue';\r\nimport { onLoad } from '@dcloudio/uni-app'\r\nimport { getReleaseDetail, getUserReleases, getUserInfo, follow, unfollow, getFollowingList } from '../../api/api';\r\n\r\n// 用户信息\r\nconst userData = reactive({})\r\nlet userID = ref<string>('')\r\n\r\n// 是否关注\r\nconst isFollowing = ref(true)\r\n\r\n// 用户作品列表\r\nconst userWorks = ref<any[]>([])\r\n\r\n// 查看作品详情\r\nconst viewWorkDetail = async (releaseID: string) => {\r\n    try {\r\n        const info = await getReleaseDetail(releaseID)\r\n        uni.navigateTo({\r\n            url: `/pages/detail/detail?info=${encodeURIComponent(JSON.stringify(info))}`\r\n        })\r\n    } catch (e) {\r\n        uni.__f__('log','at pages/follow/works.vue:85',e)\r\n        uni.showToast({\r\n            title: '获取详情失败',\r\n            icon: 'none'\r\n        })\r\n    }\r\n}\r\n\r\n// 切换关注状态\r\nconst toggleFollow = async () => {\r\n    userID.value = JSON.parse(uni.getStorageSync('userInfo')).userId\r\n    if (isFollowing.value) {\r\n        uni.showModal({\r\n            title: '提示',\r\n            content: `确定要取消关注\"${userData.userName}\"吗？`,\r\n            success: async (res) => {\r\n                if (res.confirm) {\r\n                    try {\r\n                        await unfollow(userID.value, userData.userID)\r\n                        isFollowing.value = false\r\n                        uni.showToast({\r\n                            title: '已取消关注',\r\n                            icon: 'success'\r\n                        })\r\n                    } catch (e) {\r\n                        uni.__f__('log','at pages/follow/works.vue:110',e)\r\n                        uni.showToast({\r\n                            title: '操作失败',\r\n                            icon: 'none'\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    } else {\r\n        try {\r\n            await follow(userID.value, { followUserID: userData.userID })\r\n            isFollowing.value = true\r\n            uni.showToast({\r\n                title: '关注成功',\r\n                icon: 'success'\r\n            })\r\n        } catch (e) {\r\n            uni.__f__('log','at pages/follow/works.vue:128',e)\r\n            uni.showToast({\r\n                title: '关注失败',\r\n                icon: 'none'\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\nonLoad(async (options) => {\r\n    if (options.userID) {\r\n        try {\r\n            const [worksRes, userRes] = await Promise.all([\r\n                getUserReleases(options.userID),\r\n                getUserInfo(options.userID)\r\n            ])\r\n            userWorks.value = worksRes\r\n            Object.assign(userData, userRes)\r\n            const userInfo = uni.getStorageSync('userInfo')\r\n            if (userInfo) {\r\n                const followingList = await getFollowingList(JSON.parse(userInfo).userId)\r\n                isFollowing.value = followingList.includes(options.userID)\r\n            }\r\n        } catch (e) {\r\n            uni.__f__('log','at pages/follow/works.vue:152',e)\r\n            uni.showToast({\r\n                title: '获取数据失败',\r\n                icon: 'none'\r\n            })\r\n        }\r\n    }\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.works-container {\r\n    width: 100%;\r\n    min-height: 100vh;\r\n    background: linear-gradient(to bottom, #f0f5ff, #ffffff);\r\n    display: flex;\r\n    flex-direction: column;\r\n    position: relative;\r\n    padding-bottom: 30rpx;\r\n\r\n    &::before {\r\n        content: '';\r\n        position: absolute;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        height: 400rpx;\r\n        background: linear-gradient(135deg, rgba(52, 148, 230, 0.15), rgba(236, 110, 173, 0.1));\r\n        z-index: -1;\r\n        border-radius: 0 0 30% 30%;\r\n    }\r\n\r\n    &::after {\r\n        content: '';\r\n        position: absolute;\r\n        top: 15%;\r\n        right: 5%;\r\n        width: 100rpx;\r\n        height: 100rpx;\r\n        border-radius: 50%;\r\n        background: linear-gradient(135deg, rgba(236, 110, 173, 0.2), rgba(52, 148, 230, 0.1));\r\n        filter: blur(30rpx);\r\n        z-index: -1;\r\n    }\r\n\r\n    .user-profile {\r\n        margin: 30rpx 20rpx 20rpx;\r\n        padding: 30rpx;\r\n        background-color: rgba(255, 255, 255, 0.9);\r\n        border-radius: 20rpx;\r\n        box-shadow: 0 0 15rpx 0 rgba(0, 0, 0, 0.1);\r\n        backdrop-filter: none;\r\n        border: 1px solid rgba(255, 255, 255, 0.6);\r\n        display: flex;\r\n        align-items: center;\r\n        position: relative;\r\n\r\n        .user-avatar {\r\n            width: 140rpx;\r\n            height: 140rpx;\r\n            border-radius: 50%;\r\n            margin-right: 30rpx;\r\n            box-shadow: 0 5rpx 10rpx rgba(0, 0, 0, 0.1);\r\n            border: 3rpx solid #fff;\r\n        }\r\n\r\n        .user-info {\r\n            flex: 1;\r\n\r\n            .user-name {\r\n                font-size: 36rpx;\r\n                font-weight: bold;\r\n                margin-bottom: 12rpx;\r\n                background: linear-gradient(90deg, #3494E6, #555);\r\n                -webkit-background-clip: text;\r\n                background-clip: text;\r\n                color: transparent;\r\n                margin-left: 8rpx;\r\n                text-shadow: 0 0 1px rgba(52, 148, 230, 0.1);\r\n            }\r\n\r\n            .user-stats {\r\n                display: flex;\r\n                margin-top: 15rpx;\r\n\r\n                .stat-item {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    background: rgba(52, 148, 230, 0.1);\r\n                    padding: 8rpx 20rpx;\r\n                    border-radius: 30rpx;\r\n\r\n                    .stat-value {\r\n                        font-size: 30rpx;\r\n                        font-weight: bold;\r\n                        color: #3494E6;\r\n                        margin-right: 8rpx;\r\n                    }\r\n\r\n                    .stat-label {\r\n                        font-size: 24rpx;\r\n                        color: #666;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .follow-action {\r\n            .follow-btn {\r\n                padding: 15rpx 30rpx;\r\n                border-radius: 40rpx;\r\n                font-size: 28rpx;\r\n                color: #fff;\r\n                background: linear-gradient(135deg, #3494E6, #EC6EAD);\r\n                box-shadow: 0 3rpx 8rpx rgba(0, 0, 0, 0.1);\r\n                transition: all 0.3s ease;\r\n                white-space: nowrap;\r\n\r\n                &:active {\r\n                    transform: scale(0.95);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .content-area {\r\n        flex: 1;\r\n        padding: 10rpx 20rpx 20rpx;\r\n        min-height: fit-content;\r\n        width: 95%;\r\n        margin: 0 auto;\r\n\r\n        .works-list {\r\n            .work-item {\r\n                width: 91%;\r\n                background-color: rgba(255, 255, 255, 0.9);\r\n                border-radius: 20rpx;\r\n                margin-bottom: 30rpx;\r\n                padding: 25rpx;\r\n                display: flex;\r\n                flex-direction: column;\r\n                box-shadow: 0 0 15rpx 0 rgba(0, 0, 0, 0.1);\r\n                backdrop-filter: none;\r\n                border: 1px solid rgba(255, 255, 255, 0.6);\r\n                transition: all 0.3s ease;\r\n                position: relative;\r\n                overflow: hidden;\r\n\r\n                &::before {\r\n                    content: '';\r\n                    position: absolute;\r\n                    top: 0;\r\n                    left: 0;\r\n                    width: 6rpx;\r\n                    height: 100%;\r\n                    background: linear-gradient(to bottom, #3494E6, #EC6EAD);\r\n                    opacity: 0.7;\r\n                }\r\n\r\n                &:active {\r\n                    transform: translateY(-5rpx);\r\n                    box-shadow: 0 8rpx 20rpx rgba(0, 0, 0, 0.15);\r\n                }\r\n\r\n                .work-header {\r\n                    margin-bottom: 15rpx;\r\n\r\n                    .work-title {\r\n                        font-size: 32rpx;\r\n                        font-weight: bold;\r\n                        background: linear-gradient(90deg, #3494E6, #555);\r\n                        -webkit-background-clip: text;\r\n                        background-clip: text;\r\n                        color: transparent;\r\n                        text-shadow: 0 0 1px rgba(52, 148, 230, 0.1);\r\n                        position: relative;\r\n                        padding-bottom: 10rpx;\r\n\r\n                        &::after {\r\n                            content: '';\r\n                            position: absolute;\r\n                            bottom: 0;\r\n                            left: 0;\r\n                            width: 60rpx;\r\n                            height: 3rpx;\r\n                            background: linear-gradient(90deg, #3494E6, transparent);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                .work-body {\r\n                    display: flex;\r\n                    margin-bottom: 20rpx;\r\n\r\n                    .work-image {\r\n                        width: 180rpx;\r\n                        height: 140rpx;\r\n                        border-radius: 15rpx;\r\n                        margin-right: 20rpx;\r\n                        box-shadow: 0 5rpx 10rpx rgba(0, 0, 0, 0.1);\r\n                        flex-shrink: 0;\r\n                    }\r\n\r\n                    .work-content {\r\n                        flex: 1;\r\n                        display: flex;\r\n                        flex-direction: column;\r\n                        justify-content: center;\r\n\r\n                        .work-desc {\r\n                            font-size: 26rpx;\r\n                            color: #333;\r\n                            display: -webkit-box;\r\n                            -webkit-line-clamp: 3;\r\n                            line-clamp: 3;\r\n                            -webkit-box-orient: vertical;\r\n                            text-overflow: ellipsis;\r\n                            overflow: hidden;\r\n                            line-height: 1.6;\r\n                            background: linear-gradient(90deg, rgba(52, 148, 230, 0.15), rgba(236, 110, 173, 0.05));\r\n                            padding: 10rpx 15rpx;\r\n                            border-radius: 10rpx;\r\n                            border-left: 3rpx solid rgba(52, 148, 230, 0.6);\r\n                            height: 100%;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                .work-meta {\r\n                    display: flex;\r\n                    flex-wrap: wrap;\r\n                    gap: 15rpx;\r\n                    justify-content: flex-start;\r\n                    width: 100%;\r\n\r\n                    .meta-item {\r\n                        font-size: 24rpx;\r\n                        color: #888;\r\n                        display: flex;\r\n                        align-items: center;\r\n                        background-color: rgba(0, 0, 0, 0.05);\r\n                        padding: 6rpx 16rpx;\r\n                        border-radius: 20rpx;\r\n                        width: fit-content;\r\n                        min-width: 100rpx;\r\n\r\n                        .meta-icon {\r\n                            width: 24rpx;\r\n                            height: 24rpx;\r\n                            margin-right: 8rpx;\r\n                            flex-shrink: 0;\r\n                        }\r\n\r\n                        text {\r\n                            white-space: nowrap;\r\n                            overflow: hidden;\r\n                            text-overflow: ellipsis;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .list-footer {\r\n            text-align: center;\r\n            padding: 30rpx 0;\r\n            color: #999;\r\n            font-size: 24rpx;\r\n        }\r\n\r\n        .empty-state {\r\n            display: flex;\r\n            flex-direction: column;\r\n            align-items: center;\r\n            justify-content: center;\r\n            padding: 150rpx 0;\r\n\r\n            .empty-icon {\r\n                width: 250rpx;\r\n                height: 250rpx;\r\n                margin-bottom: 40rpx;\r\n                opacity: 0.6;\r\n                animation: float 3s ease-in-out infinite;\r\n            }\r\n\r\n            .empty-text {\r\n                font-size: 36rpx;\r\n                color: #999;\r\n                margin-bottom: 15rpx;\r\n                text-shadow: 1rpx 1rpx 2rpx rgba(0, 0, 0, 0.1);\r\n            }\r\n\r\n            .empty-subtext {\r\n                font-size: 28rpx;\r\n                color: #aaa;\r\n                margin-bottom: 40rpx;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n@keyframes float {\r\n    0% {\r\n        transform: translateY(0);\r\n    }\r\n\r\n    50% {\r\n        transform: translateY(-10rpx);\r\n    }\r\n\r\n    100% {\r\n        transform: translateY(0);\r\n    }\r\n}\r\n</style>","import MiniProgramPage from 'D:/uniappProject/旅游日记uniapp/pages/follow/works.vue'\nwx.createPage(MiniProgramPage)"],"names":["reactive","ref","getReleaseDetail","uni","unfollow","follow","onLoad","getUserReleases","getUserInfo","getFollowingList"],"mappings":";;;;;;;AAmEM,UAAA,WAAWA,uBAAS,CAAA,CAAE;AACxB,QAAA,SAASC,kBAAY,EAAE;AAGrB,UAAA,cAAcA,kBAAI,IAAI;AAGtB,UAAA,YAAYA,kBAAW,CAAA,CAAE;AAGzB,UAAA,iBAAiB,OAAO,cAAsB;AAC5C,UAAA;AACM,cAAA,OAAO,MAAMC,yBAAiB,SAAS;AAC7CC,sBAAAA,MAAI,WAAW;AAAA,UACX,KAAK,6BAA6B,mBAAmB,KAAK,UAAU,IAAI,CAAC,CAAC;AAAA,QAAA,CAC7E;AAAA,eACI,GAAG;AACJA,sBAAAA,MAAA,MAAM,OAAM,gCAA+B,CAAC;AAChDA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,MAAM;AAAA,QAAA,CACT;AAAA,MACL;AAAA,IAAA;AAIJ,UAAM,eAAe,YAAY;AAC7B,aAAO,QAAQ,KAAK,MAAMA,oBAAI,eAAe,UAAU,CAAC,EAAE;AAC1D,UAAI,YAAY,OAAO;AACnBA,sBAAAA,MAAI,UAAU;AAAA,UACV,OAAO;AAAA,UACP,SAAS,WAAW,SAAS,QAAQ;AAAA,UACrC,SAAS,OAAO,QAAQ;AACpB,gBAAI,IAAI,SAAS;AACT,kBAAA;AACA,sBAAMC,QAAS,SAAA,OAAO,OAAO,SAAS,MAAM;AAC5C,4BAAY,QAAQ;AACpBD,8BAAAA,MAAI,UAAU;AAAA,kBACV,OAAO;AAAA,kBACP,MAAM;AAAA,gBAAA,CACT;AAAA,uBACI,GAAG;AACJA,8BAAAA,MAAA,MAAM,OAAM,iCAAgC,CAAC;AACjDA,8BAAAA,MAAI,UAAU;AAAA,kBACV,OAAO;AAAA,kBACP,MAAM;AAAA,gBAAA,CACT;AAAA,cACL;AAAA,YACJ;AAAA,UACJ;AAAA,QAAA,CACH;AAAA,MAAA,OACE;AACC,YAAA;AACA,gBAAME,QAAAA,OAAO,OAAO,OAAO,EAAE,cAAc,SAAS,QAAQ;AAC5D,sBAAY,QAAQ;AACpBF,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UAAA,CACT;AAAA,iBACI,GAAG;AACJA,wBAAAA,MAAA,MAAM,OAAM,iCAAgC,CAAC;AACjDA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UAAA,CACT;AAAA,QACL;AAAA,MACJ;AAAA,IAAA;AAGJG,kBAAA,OAAO,OAAO,YAAY;AACtB,UAAI,QAAQ,QAAQ;AACZ,YAAA;AACA,gBAAM,CAAC,UAAU,OAAO,IAAI,MAAM,QAAQ,IAAI;AAAA,YAC1CC,QAAA,gBAAgB,QAAQ,MAAM;AAAA,YAC9BC,QAAA,YAAY,QAAQ,MAAM;AAAA,UAAA,CAC7B;AACD,oBAAU,QAAQ;AACX,iBAAA,OAAO,UAAU,OAAO;AACzB,gBAAA,WAAWL,cAAAA,MAAI,eAAe,UAAU;AAC9C,cAAI,UAAU;AACV,kBAAM,gBAAgB,MAAMM,yBAAiB,KAAK,MAAM,QAAQ,EAAE,MAAM;AACxE,wBAAY,QAAQ,cAAc,SAAS,QAAQ,MAAM;AAAA,UAC7D;AAAA,iBACK,GAAG;AACJN,wBAAAA,MAAA,MAAM,OAAM,iCAAgC,CAAC;AACjDA,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UAAA,CACT;AAAA,QACL;AAAA,MACJ;AAAA,IAAA,CACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7JD,GAAG,WAAW,eAAe;"}