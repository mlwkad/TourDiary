{"version":3,"file":"MescrollView.js","sources":["pages/follow/components/MescrollView.vue","../../uniapp/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RDovdW5pYXBwUHJvamVjdC_ml4XmuLjml6XorrB1bmlhcHAvcGFnZXMvZm9sbG93L2NvbXBvbmVudHMvTWVzY3JvbGxWaWV3LnZ1ZQ"],"sourcesContent":["<template>\r\n    <view class=\"mescroll-container\">\r\n        <scroll-view class=\"mescroll-view\" :style=\"{ height: viewHeight }\" scroll-y @scroll=\"onScroll\"\r\n            :scroll-top=\"scrollTop\" @scrolltolower=\"handleLoadMore\" :lower-threshold=\"20\">\r\n\r\n            <!-- 下拉刷新区域 -->\r\n            <view class=\"refresh-container\"\r\n                :style=\"{ transform: `translateY(${downTranslateY}px)`, transition: isTransition ? 'transform 300ms' : '' }\">\r\n                <view class=\"refresh-text\">{{ refreshStatus }}</view>\r\n            </view>\r\n\r\n            <!-- 实际内容 -->\r\n            <slot></slot>\r\n\r\n            <!-- 上拉加载区域 -->\r\n            <view class=\"loading-container\" v-if=\"showLoading\">\r\n                <view class=\"loading-text\">{{ loadingText }}</view>\r\n            </view>\r\n        </scroll-view>\r\n    </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from 'vue';\r\n\r\n// Props\r\nconst props = defineProps({\r\n    height: {\r\n        type: String,\r\n        default: '100vh'\r\n    },\r\n    enableRefresh: {\r\n        type: Boolean,\r\n        default: true\r\n    },\r\n    enableLoadMore: {\r\n        type: Boolean,\r\n        default: false\r\n    }\r\n});\r\n\r\n// Emits\r\nconst emit = defineEmits(['refresh', 'loadMore']);\r\n\r\n// 视图高度\r\nconst viewHeight = ref(props.height);\r\n\r\n// 滚动相关\r\nconst scrollTop = ref(0);\r\nconst touchStartY = ref(0);\r\nconst downTranslateY = ref(0);\r\nconst isTransition = ref(false);\r\nconst isRefreshing = ref(false);\r\nconst showLoading = ref(false);\r\nconst loadingText = ref('加载更多...');\r\n\r\n// 刷新状态文本\r\nconst refreshStatus = computed(() => {\r\n    if (isRefreshing.value) return '刷新中...';\r\n    if (downTranslateY.value > 50) return '释放立即刷新';\r\n    return '下拉可以刷新';\r\n});\r\n\r\n// 监听滚动事件\r\nconst onScroll = (e) => {\r\n    // 此处可以处理滚动逻辑\r\n};\r\n\r\n// 开始触摸事件\r\nconst onTouchStart = (e) => {\r\n    if (!props.enableRefresh || isRefreshing.value) return;\r\n\r\n    // 如果不是在顶部，则不处理\r\n    if (scrollTop.value > 5) return;\r\n\r\n    // 记录起始触摸位置\r\n    touchStartY.value = e.touches[0].clientY;\r\n    isTransition.value = false;\r\n};\r\n\r\n// 触摸移动事件\r\nconst onTouchMove = (e) => {\r\n    if (!props.enableRefresh || isRefreshing.value) return;\r\n\r\n    // 如果不是在顶部，则不处理\r\n    if (scrollTop.value > 5) return;\r\n\r\n    // 计算下拉的距离\r\n    const moveY = e.touches[0].clientY - touchStartY.value;\r\n    if (moveY > 0) {\r\n        // 使用阻尼效果，下拉越多，阻力越大\r\n        downTranslateY.value = Math.pow(moveY, 0.8);\r\n\r\n        // 阻止页面滚动\r\n        e.preventDefault();\r\n    }\r\n};\r\n\r\n// 触摸结束事件\r\nconst onTouchEnd = () => {\r\n    if (!props.enableRefresh || isRefreshing.value) return;\r\n\r\n    isTransition.value = true;\r\n\r\n    // 判断是否达到刷新阈值\r\n    if (downTranslateY.value > 50) {\r\n        // 触发刷新\r\n        downTranslateY.value = 50;\r\n        isRefreshing.value = true;\r\n        emit('refresh', finishRefresh);\r\n    } else {\r\n        // 未达到阈值，回弹\r\n        downTranslateY.value = 0;\r\n    }\r\n};\r\n\r\n// 完成刷新\r\nconst finishRefresh = () => {\r\n    isRefreshing.value = false;\r\n    isTransition.value = true;\r\n    downTranslateY.value = 0;\r\n};\r\n\r\n// 加载更多\r\nconst handleLoadMore = () => {\r\n    if (!props.enableLoadMore) return;\r\n\r\n    showLoading.value = true;\r\n    emit('loadMore', finishLoadMore);\r\n};\r\n\r\n// 完成加载更多\r\nconst finishLoadMore = () => {\r\n    showLoading.value = false;\r\n};\r\n\r\n// 设置触摸事件监听\r\nonMounted(() => {\r\n    const container = document.querySelector('.mescroll-container');\r\n    if (container) {\r\n        container.addEventListener('touchstart', onTouchStart);\r\n        container.addEventListener('touchmove', onTouchMove);\r\n        container.addEventListener('touchend', onTouchEnd);\r\n    }\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.mescroll-container {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: relative;\r\n    overflow: hidden;\r\n\r\n    .mescroll-view {\r\n        position: relative;\r\n        width: 100%;\r\n    }\r\n\r\n    .refresh-container {\r\n        width: 100%;\r\n        height: 50px;\r\n        position: absolute;\r\n        top: -50px;\r\n        left: 0;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n\r\n        .refresh-text {\r\n            font-size: 14px;\r\n            color: #999;\r\n        }\r\n    }\r\n\r\n    .loading-container {\r\n        width: 100%;\r\n        height: 40px;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n\r\n        .loading-text {\r\n            font-size: 14px;\r\n            color: #999;\r\n        }\r\n    }\r\n}\r\n</style>","import Component from 'D:/uniappProject/旅游日记uniapp/pages/follow/components/MescrollView.vue'\nwx.createComponent(Component)"],"names":["ref","computed","onMounted"],"mappings":";;;;;;;;;;;;;;;;;;;;AA0BA,UAAM,QAAQ;AAgBd,UAAM,OAAO;AAGb,UAAM,aAAaA,cAAG,IAAC,MAAM,MAAM;AAGnC,UAAM,YAAYA,cAAAA,IAAI,CAAC;AACvB,UAAM,cAAcA,cAAAA,IAAI,CAAC;AACzB,UAAM,iBAAiBA,cAAAA,IAAI,CAAC;AAC5B,UAAM,eAAeA,cAAAA,IAAI,KAAK;AAC9B,UAAM,eAAeA,cAAAA,IAAI,KAAK;AAC9B,UAAM,cAAcA,cAAAA,IAAI,KAAK;AAC7B,UAAM,cAAcA,cAAAA,IAAI,SAAS;AAGjC,UAAM,gBAAgBC,cAAQ,SAAC,MAAM;AACjC,UAAI,aAAa;AAAO,eAAO;AAC/B,UAAI,eAAe,QAAQ;AAAI,eAAO;AACtC,aAAO;AAAA,IACX,CAAC;AAGD,UAAM,WAAW,CAAC,MAAM;AAAA,IAExB;AAGA,UAAM,eAAe,CAAC,MAAM;AACxB,UAAI,CAAC,MAAM,iBAAiB,aAAa;AAAO;AAGhD,UAAI,UAAU,QAAQ;AAAG;AAGzB,kBAAY,QAAQ,EAAE,QAAQ,CAAC,EAAE;AACjC,mBAAa,QAAQ;AAAA,IACzB;AAGA,UAAM,cAAc,CAAC,MAAM;AACvB,UAAI,CAAC,MAAM,iBAAiB,aAAa;AAAO;AAGhD,UAAI,UAAU,QAAQ;AAAG;AAGzB,YAAM,QAAQ,EAAE,QAAQ,CAAC,EAAE,UAAU,YAAY;AACjD,UAAI,QAAQ,GAAG;AAEX,uBAAe,QAAQ,KAAK,IAAI,OAAO,GAAG;AAG1C,UAAE,eAAc;AAAA,MACnB;AAAA,IACL;AAGA,UAAM,aAAa,MAAM;AACrB,UAAI,CAAC,MAAM,iBAAiB,aAAa;AAAO;AAEhD,mBAAa,QAAQ;AAGrB,UAAI,eAAe,QAAQ,IAAI;AAE3B,uBAAe,QAAQ;AACvB,qBAAa,QAAQ;AACrB,aAAK,WAAW,aAAa;AAAA,MACrC,OAAW;AAEH,uBAAe,QAAQ;AAAA,MAC1B;AAAA,IACL;AAGA,UAAM,gBAAgB,MAAM;AACxB,mBAAa,QAAQ;AACrB,mBAAa,QAAQ;AACrB,qBAAe,QAAQ;AAAA,IAC3B;AAGA,UAAM,iBAAiB,MAAM;AACzB,UAAI,CAAC,MAAM;AAAgB;AAE3B,kBAAY,QAAQ;AACpB,WAAK,YAAY,cAAc;AAAA,IACnC;AAGA,UAAM,iBAAiB,MAAM;AACzB,kBAAY,QAAQ;AAAA,IACxB;AAGAC,kBAAAA,UAAU,MAAM;AACZ,YAAM,YAAY,SAAS,cAAc,qBAAqB;AAC9D,UAAI,WAAW;AACX,kBAAU,iBAAiB,cAAc,YAAY;AACrD,kBAAU,iBAAiB,aAAa,WAAW;AACnD,kBAAU,iBAAiB,YAAY,UAAU;AAAA,MACpD;AAAA,IACL,CAAC;;;;;;;;;;;;;;;;;;;AC/ID,GAAG,gBAAgB,SAAS;"}