{"version":3,"file":"note-edit.js","sources":["pages/notes/note-edit.vue","../../uniapp/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbm90ZXMvbm90ZS1lZGl0LnZ1ZQ"],"sourcesContent":["<template>\r\n    <view class=\"note-edit-container\">\r\n        <!-- 编辑区域 -->\r\n        <scroll-view scroll-y class=\"edit-area\">\r\n            <input class=\"note-title-input\" placeholder=\"请输入标题...\" v-model=\"note.title\" maxlength=\"50\" />\r\n\r\n            <view class=\"location-selector\" @click=\"chooseLocation\">\r\n                <image src=\"/static/public/search.png\" mode=\"aspectFit\"></image>\r\n                <text v-if=\"note.location\">{{ note.location }}</text>\r\n                <text v-else class=\"placeholder\">添加位置</text>\r\n            </view>\r\n\r\n            <textarea class=\"note-content-input\" placeholder=\"写下你的旅行记录...\" v-model=\"note.content\" maxlength=\"5000\"\r\n                auto-height />\r\n\r\n            <view class=\"image-section\">\r\n                <view class=\"image-list\">\r\n                    <view class=\"image-item\" v-for=\"(img, index) in note.images\" :key=\"index\">\r\n                        <image class=\"preview-image\" :src=\"img\" mode=\"aspectFill\"></image>\r\n                        <view class=\"delete-btn\" @click=\"removeImage(index)\">\r\n                            <image src=\"/static/public/close.png\" mode=\"aspectFit\"></image>\r\n                        </view>\r\n                    </view>\r\n                    <view class=\"add-image-btn\" @click=\"chooseImage\" v-if=\"note.images.length < 9\">\r\n                        <text>+</text>\r\n                        <text class=\"add-text\">添加图片</text>\r\n                    </view>\r\n                </view>\r\n            </view>\r\n        </scroll-view>\r\n\r\n        <!-- 底部保存按钮 -->\r\n        <view class=\"save-button\" @click=\"saveNote\">保存笔记</view>\r\n    </view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, onMounted } from 'vue';\r\nimport { onLoad, onBackPress } from '@dcloudio/uni-app';\r\n\r\n// 状态\r\nconst isEdit = ref(false);\r\n\r\n// 笔记数据\r\nconst note = reactive({\r\n    id: '',\r\n    title: '',\r\n    content: '',\r\n    location: '',\r\n    date: '',\r\n    isFavorite: false,\r\n    images: [] as string[]\r\n});\r\n\r\n// 获取笔记详情\r\nconst getNoteDetail = (id: string) => {\r\n    // 这里应该是从API获取数据，现在用模拟数据\r\n    setTimeout(() => {\r\n        Object.assign(note, {\r\n            id: id,\r\n            title: '桂林游记',\r\n            content: '今天游览了桂林的象鼻山和七星公园，风景如画，令人心旷神怡。象鼻山位于桂林市漓江与桃花江汇流处，因山形酷似一头伸鼻饮水的大象而得名，是桂林山水的标志性景观。\\n\\n七星公园是桂林最大的综合性公园，因园内有七座山峰，恰似北斗七星而得名。公园内有桂海碑林、七星岩、蛇山、华夏奇石馆、花桥、童子拜观音等景点。尤其是华夏奇石馆内的奇石，形态各异，令人叹为观止。\\n\\n漓江水清澈见底，两岸的喀斯特地貌景观壮观秀丽，船行其上，恍如画中。整个旅程给人一种身临仙境的感觉，不虚此行。',\r\n            location: '广西桂林',\r\n            date: '2023-10-15',\r\n            isFavorite: true,\r\n            images: ['/static/666.jpg', '/static/666.jpg', '/static/666.jpg']\r\n        });\r\n    }, 500);\r\n};\r\n\r\n// 处理后退按钮\r\nonBackPress(() => {\r\n    if (note.title || note.content || note.images.length > 0) {\r\n        uni.showModal({\r\n            title: '提示',\r\n            content: '是否放弃此次编辑？',\r\n            success: (res) => {\r\n                if (res.confirm) {\r\n                    uni.navigateBack();\r\n                }\r\n            }\r\n        });\r\n        return true;\r\n    }\r\n    return false;\r\n});\r\n\r\n// 保存笔记\r\nconst saveNote = () => {\r\n    if (!note.title) {\r\n        uni.showToast({\r\n            title: '请输入标题',\r\n            icon: 'none'\r\n        });\r\n        return;\r\n    }\r\n\r\n    if (!note.content) {\r\n        uni.showToast({\r\n            title: '请输入内容',\r\n            icon: 'none'\r\n        });\r\n        return;\r\n    }\r\n\r\n    // 设置当前日期\r\n    if (!note.date) {\r\n        const now = new Date();\r\n        note.date = now.getFullYear() + '-' +\r\n            String(now.getMonth() + 1).padStart(2, '0') + '-' +\r\n            String(now.getDate()).padStart(2, '0');\r\n    }\r\n\r\n    // 这里应该调用API保存笔记\r\n    uni.showLoading({\r\n        title: '保存中'\r\n    });\r\n\r\n    setTimeout(() => {\r\n        uni.hideLoading();\r\n        uni.showToast({\r\n            title: '保存成功',\r\n            icon: 'success'\r\n        });\r\n\r\n        setTimeout(() => {\r\n            uni.navigateBack();\r\n        }, 1000);\r\n    }, 1000);\r\n};\r\n\r\n// 选择位置\r\nconst chooseLocation = () => {\r\n    uni.chooseLocation({\r\n        success: (res) => {\r\n            note.location = res.name || res.address;\r\n        },\r\n        fail: (err) => {\r\n            // 用户取消或发生错误\r\n            uni.__f__('error','at pages/notes/note-edit.vue:140','选择位置失败', err);\r\n        }\r\n    });\r\n};\r\n\r\n// 选择图片\r\nconst chooseImage = () => {\r\n    uni.chooseImage({\r\n        count: 9 - note.images.length,\r\n        sizeType: ['compressed'],\r\n        sourceType: ['album', 'camera'],\r\n        success: (res) => {\r\n            // 这里应该上传图片到服务器，目前直接使用本地路径\r\n            note.images = [...note.images, ...res.tempFilePaths];\r\n        }\r\n    });\r\n};\r\n\r\n// 移除图片\r\nconst removeImage = (index: number) => {\r\n    note.images.splice(index, 1);\r\n};\r\n\r\nonLoad((options) => {\r\n    if (options.id) {\r\n        isEdit.value = true;\r\n        getNoteDetail(options.id);\r\n        uni.setNavigationBarTitle({\r\n            title: '编辑笔记'\r\n        });\r\n    } else {\r\n        uni.setNavigationBarTitle({\r\n            title: '新建笔记'\r\n        });\r\n    }\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.note-edit-container {\r\n    width: 100%;\r\n    min-height: 100vh;\r\n    background-color: #fff;\r\n    display: flex;\r\n    flex-direction: column;\r\n    position: relative;\r\n    padding-bottom: 120rpx;\r\n\r\n    .edit-area {\r\n        flex: 1;\r\n        padding: 30rpx;\r\n\r\n        .note-title-input {\r\n            font-size: 36rpx;\r\n            font-weight: bold;\r\n            padding: 20rpx 0;\r\n            border-bottom: 1rpx solid #f0f0f0;\r\n            margin-bottom: 20rpx;\r\n        }\r\n\r\n        .location-selector {\r\n            display: flex;\r\n            align-items: center;\r\n            padding: 20rpx 0;\r\n            border-bottom: 1rpx solid #f0f0f0;\r\n            margin-bottom: 20rpx;\r\n\r\n            image {\r\n                width: 32rpx;\r\n                height: 32rpx;\r\n                margin-right: 10rpx;\r\n            }\r\n\r\n            text {\r\n                font-size: 28rpx;\r\n                color: #333;\r\n            }\r\n\r\n            .placeholder {\r\n                color: #999;\r\n            }\r\n        }\r\n\r\n        .note-content-input {\r\n            width: 100%;\r\n            font-size: 30rpx;\r\n            line-height: 1.8;\r\n            min-height: 300rpx;\r\n            padding: 20rpx 0;\r\n            margin-bottom: 30rpx;\r\n        }\r\n\r\n        .image-section {\r\n            padding: 20rpx 0;\r\n\r\n            .image-list {\r\n                display: flex;\r\n                flex-wrap: wrap;\r\n                gap: 20rpx;\r\n\r\n                .image-item {\r\n                    width: 210rpx;\r\n                    height: 210rpx;\r\n                    position: relative;\r\n\r\n                    .preview-image {\r\n                        width: 100%;\r\n                        height: 100%;\r\n                        border-radius: 8rpx;\r\n                    }\r\n\r\n                    .delete-btn {\r\n                        position: absolute;\r\n                        top: -10rpx;\r\n                        right: -10rpx;\r\n                        width: 40rpx;\r\n                        height: 40rpx;\r\n                        background-color: rgba(0, 0, 0, 0.5);\r\n                        border-radius: 50%;\r\n                        display: flex;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n\r\n                        image {\r\n                            width: 24rpx;\r\n                            height: 24rpx;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                .add-image-btn {\r\n                    width: 210rpx;\r\n                    height: 210rpx;\r\n                    border: 1rpx dashed #ddd;\r\n                    border-radius: 8rpx;\r\n                    display: flex;\r\n                    flex-direction: column;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n\r\n                    text {\r\n                        font-size: 50rpx;\r\n                        color: #ddd;\r\n                        line-height: 1;\r\n                        margin-bottom: 10rpx;\r\n                    }\r\n\r\n                    .add-text {\r\n                        font-size: 28rpx;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .save-button {\r\n        position: fixed;\r\n        bottom: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100rpx;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        background: linear-gradient(to right, #4bb0ff, #61e4ff);\r\n        color: #fff;\r\n        font-size: 32rpx;\r\n        font-weight: bold;\r\n        z-index: 10;\r\n    }\r\n}\r\n</style>","import MiniProgramPage from 'D:/uniappProject/旅游日记uniapp/pages/notes/note-edit.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","onBackPress","uni","onLoad"],"mappings":"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"}