"use strict";function e(e){if(!e)return"";return e.replace(/('|"|;|--|\/\*|\*\/|@@|@|char|nchar|varchar|nvarchar|alter|begin|cast|create|cursor|declare|delete|drop|end|exec|execute|fetch|insert|kill|open|select|sys|sysobjects|syscolumns|table|update)/gi,"").replace(/[<>]/g,"").trim()}exports.validateContent=function(t,i=10){if(!t||!t.trim())return{isValid:!1,message:"内容描述不能为空",filteredText:""};const s=e(t);return s.length<i?{isValid:!1,message:`内容描述不能少于${i}个字符`,filteredText:s}:/(赌博|色情|暴力|政治|违法)/gi.test(s)?{isValid:!1,message:"内容包含敏感词汇",filteredText:s}:{isValid:!0,message:"",filteredText:s}},exports.validateLocation=function(t){if(!t||!t.trim())return{isValid:!1,message:"位置不能为空",filteredText:""};const i=e(t);return i.length>25?{isValid:!1,message:"位置信息过长",filteredText:i}:{isValid:!0,message:"",filteredText:i}},exports.validatePassword=function(e){return e?e.length<6?{isValid:!1,message:"密码不能少于6个字符",filteredText:e}:e.length>20?{isValid:!1,message:"密码不能超过20个字符",filteredText:e}:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{6,}$/.test(e)?{isValid:!0,message:"",filteredText:e}:{isValid:!1,message:"密码必须包含至少一个字母和一个数字",filteredText:e}:{isValid:!1,message:"密码不能为空",filteredText:""}},exports.validateSearch=function(t){if(!t||!t.trim())return{isValid:!1,message:"搜索内容不能为空",filteredText:""};const i=e(t);return i.length>10?{isValid:!1,message:"搜索内容不能超过10个字符",filteredText:i.substring(0,10)}:/(赌博|色情|暴力|政治|违法)/gi.test(i)?{isValid:!1,message:"搜索内容包含敏感词汇",filteredText:i}:{isValid:!0,message:"",filteredText:i}},exports.validateTitle=function(t,i=15){if(!t||!t.trim())return{isValid:!1,message:"标题不能为空",filteredText:""};const s=e(t);return s.length>i?{isValid:!1,message:`标题不能超过${i}个字符`,filteredText:s}:/(赌博|色情|暴力|政治|违法)/gi.test(s)?{isValid:!1,message:"标题包含敏感词汇",filteredText:s}:{isValid:!0,message:"",filteredText:s}},exports.validateUsername=function(t){if(!t||!t.trim())return{isValid:!1,message:"用户名不能为空",filteredText:""};const i=e(t);return i.length<3?{isValid:!1,message:"用户名不能少于3个字符",filteredText:i}:i.length>20?{isValid:!1,message:"用户名不能超过20个字符",filteredText:i}:/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/.test(i)?/(赌博|色情|暴力|政治|违法)/gi.test(i)?{isValid:!1,message:"用户名包含敏感词汇",filteredText:i}:{isValid:!0,message:"",filteredText:i}:{isValid:!1,message:"用户名只能包含字母、数字、下划线和中文",filteredText:i}};
