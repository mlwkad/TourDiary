"use strict";const e=require("../common/vendor.js"),t=/(赌博|色情|暴力|政治|违法)/gi;function i(t){return t?e.sqlstring.escape(t).replace(/[<>'"]/g,"").trim():""}exports.validateContent=function(e,s=10){if(!e||!e.trim())return{isValid:!1,message:"内容描述不能为空",filteredText:""};const a=i(e);return a.length<s?{isValid:!1,message:`内容描述不能少于${s}个字符`,filteredText:a}:t.test(a)?{isValid:!1,message:"内容包含敏感词汇",filteredText:a}:{isValid:!0,message:"",filteredText:a}},exports.validateLocation=function(e){if(!e||!e.trim())return{isValid:!1,message:"位置不能为空",filteredText:""};const t=i(e);return t.length>25?{isValid:!1,message:"位置信息过长",filteredText:t}:{isValid:!0,message:"",filteredText:t}},exports.validatePassword=function(e){return e?e.length<6?{isValid:!1,message:"密码不能少于6个字符",filteredText:e}:e.length>20?{isValid:!1,message:"密码不能超过20个字符",filteredText:e}:/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d@$!%*#?&]{6,}$/.test(e)?{isValid:!0,message:"",filteredText:e}:{isValid:!1,message:"密码必须包含至少一个字母和一个数字",filteredText:e}:{isValid:!1,message:"密码不能为空",filteredText:""}},exports.validateSearch=function(e){if(!e||!e.trim())return{isValid:!1,message:"搜索内容不能为空",filteredText:""};const s=i(e);return s.length>10?{isValid:!1,message:"搜索内容不能超过10个字符",filteredText:s.substring(0,10)}:t.test(s)?{isValid:!1,message:"搜索内容包含敏感词汇",filteredText:s}:{isValid:!0,message:"",filteredText:s}},exports.validateTitle=function(e,s=15){if(!e||!e.trim())return{isValid:!1,message:"标题不能为空",filteredText:""};const a=i(e);return a.length>s?{isValid:!1,message:`标题不能超过${s}个字符`,filteredText:a}:t.test(a)?{isValid:!1,message:"标题包含敏感词汇",filteredText:a}:{isValid:!0,message:"",filteredText:a}},exports.validateUsername=function(e){if(!e||!e.trim())return{isValid:!1,message:"用户名不能为空",filteredText:""};const s=i(e);return s.length<3?{isValid:!1,message:"用户名不能少于3个字符",filteredText:s}:s.length>20?{isValid:!1,message:"用户名不能超过20个字符",filteredText:s}:/^[a-zA-Z0-9_\u4e00-\u9fa5]+$/.test(s)?t.test(s)?{isValid:!1,message:"用户名包含敏感词汇",filteredText:s}:{isValid:!0,message:"",filteredText:s}:{isValid:!1,message:"用户名只能包含字母、数字、下划线和中文",filteredText:s}};
